@model AlphaBugTracker.Models.Ticket

@{
    ViewData["Title"] = "Details";
}

<h1>Details</h1>

<div>
    <h4>Ticket</h4>
    <hr />
    <dl class="row">
        <dt class = "col-sm-2">
            Title 
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Title)
        </dd>
        <dt class = "col-sm-2">
            Description
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Description)
        </dd>
        <dt class = "col-sm-2">
            Created Date
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.CreatedDate)
        </dd>
        <dt class = "col-sm-2">
            Updated Date
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.UpdatedDate)
        </dd>
        <dt class = "col-sm-2">
            Type
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.TicketTypeId)
        </dd>
        <dt class = "col-sm-2">
            Priority
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.TicketPriorityId)
        </dd>
        <dt class = "col-sm-2">
            Status
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.TicketStatusId)
        </dd>
        <dt class = "col-sm-2">
            Project
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Project.Name)
        </dd>
        <dt class = "col-sm-2">
            Owner
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.OwnerUser.UserName)
        </dd>
        <dt class = "col-sm-2">
            Assigned to:
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.AssignedToUser.UserName)
        </dd>
    </dl>
</div>
 <a asp-action="SelectUserToassign"  asp-controller="Ticket" asp-route-ticketId="@Model?.Id">Assign a user</a> 
<h4> Comments</h4>

@if (@Model.TicketComments.Count()>0)
{
    <table class="table">
        <thead>
            <tr>
                <th>
                    Created
                </th>
                <th>
                    Comment
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var comment in Model.TicketComments)
            {
            <tr>
                <td>
                   @comment.CreatedDate
                </td>
                <td>
                   @comment.Comment
                </td>
            </tr>    
            }
        </tbody>
    </table>

} 
else
{
    <h6> This ticket has no comments yet....</h6>
}
 <a asp-action="Create"  asp-controller="Comment" asp-route-id="@Model?.Id">Comments</a> |
 <p></p>

<h4>History</h4>

@if (@Model.TicketHistories.Count()>0)
{
    <table class="table">
        <thead>
            <tr>
                <th>
                    Updated
                </th>
                <th>
                    Title
                </th>
                <th>
                    Description
                </th>
                <th>
                    Type
                </th>
                <th>
                    Priority
                </th>
                <th>
                    Status
                </th>
                <th>
                    Assigned to
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var h in Model.TicketHistories)
            {
                <tr>
                    <td>
                       @h.UpdatedDate
                    </td>
                    <td>
                       @h.Title
                    </td>
                    <td>
                       @h.Description
                    </td>
                    <td>
                       @h.TicketTypeId
                    </td>
                    <td>
                       @h.TicketPriorityId
                    </td>
                    <td>
                       @h.TicketStatusId
                    </td>
                    <td>
                       @h.AssignedToUser.UserName
                    </td>
                </tr>    
              }
        </tbody>
    </table>
} 
else
{
    <h6> This ticket has no changes....</h6>
}




<div>
   
    <a asp-action="Index">Back to List</a>
</div>
